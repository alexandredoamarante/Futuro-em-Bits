document.addEventListener("DOMContentLoaded",()=>{let e=window.location.hostname.includes("github.io")?"/Futuro-em-Bits/":"./",t=document.querySelector("main");function a(){let e=document.getElementById("feb-year");e&&(e.textContent=new Date().getFullYear())}function i(){let e=document.getElementById("theme-toggle");e&&("dark"===localStorage.getItem("theme")&&document.body.classList.add("dark-mode"),e.dataset.fbDarkInit||(e.addEventListener("click",()=>{document.body.classList.toggle("dark-mode");let e=document.body.classList.contains("dark-mode")?"dark":"light";localStorage.setItem("theme",e)}),e.dataset.fbDarkInit="1"))}function l(){let e=document.querySelector(".gallery-grid"),t=document.getElementById("feb-lightbox");if(!e||!t)return;let a=t.querySelector("img"),i=document.getElementById("feb-lb-close");if(e.querySelectorAll("a").forEach(e=>{"1"!==e.dataset.fbLb&&(e.addEventListener("click",l=>{l.preventDefault(),e.dataset.fbLastFocus=document.activeElement?.tagName||"",a.src=e.href,a.alt=e.querySelector("img")?.alt||"Imagem da galeria",t.classList.add("active"),t.setAttribute("aria-hidden","false"),i.focus()}),e.dataset.fbLb="1")}),!t.dataset.fbLbCloseInit){function l(){t.classList.remove("active"),t.setAttribute("aria-hidden","true"),a.src="";document.querySelector("[data-fb-last-focus]")?.focus()}i.addEventListener("click",l),t.addEventListener("click",e=>{e.target===t&&l()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&l()}),t.dataset.fbLbCloseInit="1"}}function r(){document.querySelectorAll('input[name="cpf"], #cpf').forEach(e=>{e.dataset.fbMask||(e.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"").slice(0,11);t=t.replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),e.target.value=t}),e.dataset.fbMask="1")}),document.querySelectorAll('input[type="tel"], input[name="telefone"], #telefone').forEach(e=>{e.dataset.fbMask||(e.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"").slice(0,11);t=(t=t.replace(/^(\d{2})(\d)/,"($1) $2")).length>10?t.replace(/(\d{5})(\d{4})$/,"$1-$2"):t.replace(/(\d{4})(\d{4})$/,"$1-$2"),e.target.value=t}),e.dataset.fbMask="1")}),document.querySelectorAll('input[name="cep"], #cep').forEach(e=>{e.dataset.fbMask||(e.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"").slice(0,8);t=t.replace(/(\d{5})(\d)/,"$1-$2"),e.target.value=t}),e.dataset.fbMask="1")})}function n(){window.fb_forms_initialized||(document.addEventListener("submit",function(e){let t=e.target;if(!(t instanceof HTMLFormElement))return;e.preventDefault();let a=!0;if(t.querySelectorAll("input, textarea, select").forEach(e=>{e.setCustomValidity(""),e.hasAttribute("required")&&!e.value.trim()&&(e.setCustomValidity("Este campo \xe9 obrigat\xf3rio."),a=!1),"email"===e.type&&e.value&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value)&&(e.setCustomValidity("Digite um e-mail v\xe1lido."),a=!1),"cpf"===e.name&&e.value&&!s(e.value)&&(e.setCustomValidity("CPF inv\xe1lido."),a=!1),"tel"===e.type&&e.value&&e.value.replace(/\D/g,"").length<10&&(e.setCustomValidity("Telefone incompleto."),a=!1),"cep"===e.name&&e.value&&8!==e.value.replace(/\D/g,"").length&&(e.setCustomValidity("CEP inv\xe1lido."),a=!1)}),!a){t.reportValidity();return}alert("Formul\xe1rio enviado com sucesso!"),console.log("Formul\xe1rio (simulado):",Object.fromEntries(new FormData(t).entries())),t.reset()},!0),window.fb_forms_initialized=!0)}function s(e){if(!(e=e.replace(/\D/g,""))||11!==e.length||/^(\d)\1{10}$/.test(e))return!1;let t=0,a;for(let i=1;i<=9;i++)t+=parseInt(e.substring(i-1,i))*(11-i);if((a=10==(a=10*t%11)||11===a?0:a)!==parseInt(e.substring(9,10)))return!1;t=0;for(let l=1;l<=10;l++)t+=parseInt(e.substring(l-1,l))*(12-l);return(a=10==(a=10*t%11)||11===a?0:a)===parseInt(e.substring(10,11))}async function d(s){try{let d=(s||"").trim();""===d||"./"===d||"/"===d||"index.html"===d||"#"===d?d=e+"index.html":d.startsWith("pages/")||(d=e+"pages/"+d.split("/").pop());let o=await fetch(d);if(!o.ok)throw Error("Falha ao carregar "+d);let c=await o.text(),u=document.createElement("div");u.innerHTML=c;let f=u.querySelector("main")||u;t.innerHTML=f.innerHTML,l(),r(),n(),a(),i()}catch(_){console.error(_),t.innerHTML=`<p style="color:red;">Falha ao carregar o conte\xfado.</p>`}}function o(){window.fb_links_initialized||(document.addEventListener("click",e=>{let t=e.target.closest('a[href$=".html"]');if(!t)return;let a=t.getAttribute("href");!a||a.startsWith("http")||a.startsWith("mailto:")||a.startsWith("#")||(e.preventDefault(),d(a),window.history.pushState({page:a},"",a.split("/").pop()))},!1),window.fb_links_initialized=!0)}o(),a(),l(),r(),n(),i(),window.addEventListener("popstate",e=>{d(e.state?.page||"index.html")})});